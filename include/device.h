/*
 *  device.h
 *  Device-specific definitions for the scsisim library. If you want
 *  to add support for a new device, this is the place to do it.
 *
 *  This is an internal interface file for the scsisim library.
 *
 *  Copyright (c) 2017, Chris Coffey <kpuc@sdf.org>
 *
 *  Permission to use, copy, modify, and/or distribute this software
 *  for any purpose with or without fee is hereby granted, provided
 *  that the above copyright notice and this permission notice appear
 *  in all copies.
 *
 *  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL 
 *  WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED
 *  WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
 *  AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
 *  DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA
 *  OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
 *  TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 *  PERFORMANCE OF THIS SOFTWARE.
 */

#ifndef __SCSISIM_DEVICE_H__
#define __SCSISIM_DEVICE_H__

#include <stddef.h>

#include "gsm.h"


/* List of supported SIM card readers. Arranged by USB vendor ID, product ID, 
 * and index into "sim_devices" struct defined further below. */
static const unsigned int supported_devices[][3] = {
	{ 0x0420, 0x1307, 0 },	/* "Chips and Technologies Celly SIM Card Reader" */
	/* Add future devices here */
	{ 0, 0, 0 }
};

/* SCSI READ/WRITE operation codes; see SCSI spec for details */
#define SCSI_CMD_READ_6		0x08	/* READ (6) */
#define SCSI_CMD_WRITE_6	0x0a	/* WRITE (6) */
#define SCSI_CMD_READ_10	0x28	/* READ (10) */
#define SCSI_CMD_WRITE_10	0x2a	/* WRITE (10) */
#define SCSI_CMD_READ_12	0xa8	/* READ (12) */
#define SCSI_CMD_WRITE_12	0xaa	/* WRITE (12) */
#define SCSI_CMD_READ_16	0x88	/* READ (16) */
#define SCSI_CMD_WRITE_16	0x8a	/* WRITE (16) */

#define MAX_CDB_LEN	16	/* Support SCSI READ/WRITE CDBs up to 16 bytes long */

/* Celly SIM Card Reader:
 * Device initialization data - write buffer 1 */
static const unsigned char celly_buf_1[512] = {
	0x5a, 0x5a, 0x5a, 0x5a, 0xbe, 0x54, 0x62, 0x0d, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x01, 0x00, 0xc9, 0xee, 0xdb, 0xda, 0xca, 0xd0, 0xd0, 0xbe, 0xb0, 0xee,
	0xce, 0xa2, 0xb5, 0xe7, 0xd7, 0xd3, 0xd3, 0xd0, 0xcf, 0xde, 0xb9, 0xab,
	0xcb, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46, 0x6c,
	0x61, 0x73, 0x68, 0x20, 0x44, 0x69, 0x73, 0x6b, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x02, 0x25, 0x06,
	0x43, 0x68, 0x69, 0x70, 0x73, 0x42, 0x6e, 0x6b, 0x46, 0x6c, 0x61, 0x73,
	0x68, 0x20, 0x44, 0x69, 0x73, 0x6b, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
	0x38, 0x39, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x21, 0x00, 0x42, 0x00,
	0x00, 0x00, 0x1f, 0x00, 0x04, 0x80, 0x00, 0x01, 0x00, 0xe8, 0x03, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe8, 0x03, 0x00,
	0x00, 0xe8, 0x03, 0x00, 0x40, 0x00, 0x00, 0x04, 0x00, 0x04, 0x00, 0x01,
	0x02, 0x03, 0x04, 0x00, 0xff, 0x00, 0x08, 0x00, 0x84, 0x01, 0x02, 0x02,
	0x00, 0x08, 0x00, 0x00, 0x00, 0x10, 0x02, 0x01, 0xfd, 0x00, 0x00, 0x01,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x43,
	0x68, 0x69, 0x70, 0x73, 0x42, 0x61, 0x6e, 0x6b
};

/* Celly SIM Card Reader:
 * Device initialization data - write buffer 2 */
static const unsigned char celly_buf_2[4096] = {
	0x06, 0x58, 0x60, 0x00, 0x06, 0x00, 0x68, 0x00, 0x06, 0x58, 0x60, 0x00,
	0x06, 0x58, 0x60, 0x00, 0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00,
	0x06, 0x38, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00,
	0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00,
	0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00,
	0x06, 0x94, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00,
	0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00, 0x06, 0xf8, 0x67, 0x00,
	0x06, 0xf8, 0x67, 0x00, 0x11, 0x00, 0x04, 0x00, 0x17, 0xa0, 0x02, 0x02,
	0x11, 0x00, 0x00, 0x00, 0x17, 0x60, 0x02, 0x01, 0x10, 0xfc, 0xff, 0x03,
	0x11, 0xfc, 0xff, 0x03, 0x1b, 0xb8, 0x02, 0x00, 0x90, 0x00, 0x04, 0x00,
	0x50, 0x00, 0x02, 0x00, 0x03, 0x48, 0x5b, 0x00, 0xdc, 0xd8, 0x02, 0x00,
	0x10, 0xfc, 0xff, 0x03, 0x11, 0x3c, 0x00, 0x00, 0xe4, 0x00, 0x00, 0x00,
	0x1b, 0xdc, 0x02, 0x00, 0xd6, 0x00, 0x00, 0x00, 0x2a, 0x00, 0xc0, 0x03,
	0x2a, 0x00, 0x00, 0x02, 0x50, 0x1c, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00,
	0x03, 0x28, 0x51, 0x00, 0x5c, 0x30, 0x02, 0x00, 0x70, 0x14, 0x00, 0x00,
	0x0b, 0xc8, 0x60, 0x00, 0x30, 0x00, 0x00, 0x00, 0x0c, 0xc8, 0x60, 0x00,
	0x27, 0x00, 0x00, 0x00, 0x17, 0xac, 0x42, 0x00, 0x18, 0xd8, 0x02, 0x02,
	0x2a, 0x00, 0x80, 0x00, 0x50, 0x0c, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00,
	0x29, 0x00, 0x00, 0x02, 0x17, 0xd8, 0x82, 0x00, 0x18, 0xd8, 0x02, 0x01,
	0x2a, 0x00, 0x00, 0x01, 0x50, 0x1c, 0x00, 0x00, 0x64, 0x00, 0x00, 0x00,
	0x17, 0xd8, 0x42, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x07, 0x60, 0x63, 0x00,
	0x2c, 0x04, 0x00, 0x00, 0x07, 0x3c, 0x61, 0x00, 0x2c, 0x14, 0x00, 0x00,
	0x07, 0x1c, 0x61, 0x00, 0x18, 0x20, 0xc2, 0x00, 0x17, 0xec, 0xc2, 0x00,
	0x03, 0x78, 0x65, 0x00, 0x06, 0xc4, 0x61, 0x00, 0x03, 0xd4, 0x61, 0x00,
	0x10, 0xfc, 0xff, 0x03, 0x11, 0xfc, 0xff, 0x03, 0x1b, 0x90, 0x02, 0x00,
	0x18, 0x20, 0xc2, 0x00, 0x17, 0xec, 0xc2, 0x00, 0x03, 0x78, 0x65, 0x00,
	0x06, 0xc8, 0x61, 0x00, 0x03, 0x9c, 0x63, 0x00, 0x18, 0x20, 0xc2, 0x00,
	0x17, 0xec, 0xc2, 0x00, 0x1c, 0xd8, 0x02, 0x00, 0x01, 0x00, 0x00, 0x00,
	0x10, 0x14, 0x00, 0x00, 0x17, 0xd8, 0x42, 0x00, 0x03, 0x78, 0x65, 0x00,
	0x02, 0x00, 0x00, 0x00, 0x1b, 0xd8, 0x02, 0x00, 0x18, 0xd8, 0x82, 0x00,
	0x2c, 0x00, 0x00, 0x00, 0x07, 0xa0, 0x61, 0x00, 0x2c, 0x04, 0x00, 0x00,
	0x07, 0xac, 0x61, 0x00, 0xb1, 0x19, 0x00, 0x00, 0x03, 0x64, 0x62, 0x00,
	0x03, 0x78, 0x62, 0x00, 0x03, 0x8c, 0x62, 0x00, 0x03, 0x94, 0x62, 0x00,
	0xb2, 0x19, 0x00, 0x00, 0x03, 0x64, 0x62, 0x00, 0x03, 0x54, 0x62, 0x00,
	0xb1, 0x19, 0x00, 0x00, 0x06, 0xc4, 0x61, 0x00, 0x03, 0x64, 0x62, 0x00,
	0x03, 0x78, 0x62, 0x00, 0x06, 0xc4, 0x61, 0x00, 0xb1, 0x19, 0x00, 0x00,
	0x03, 0x8c, 0x62, 0x00, 0x03, 0x94, 0x62, 0x00, 0xb2, 0x19, 0x00, 0x00,
	0x03, 0x8c, 0x62, 0x00, 0xb1, 0x19, 0x00, 0x00, 0x03, 0xd4, 0x61, 0x00,
	0x03, 0x34, 0x63, 0x00, 0x91, 0x00, 0x08, 0x00, 0x06, 0x1c, 0x57, 0x00,
	0x03, 0x34, 0x62, 0x00, 0x16, 0x04, 0x00, 0x00, 0x9c, 0xdc, 0x02, 0x00,
	0x18, 0x20, 0xc2, 0x00, 0xa3, 0x00, 0x00, 0x00, 0x16, 0x08, 0x00, 0x00,
	0x41, 0x00, 0x00, 0x00, 0x03, 0x24, 0x14, 0x00, 0x18, 0x20, 0xc2, 0x00,
	0xa1, 0x00, 0x00, 0x00, 0x16, 0x08, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00,
	0x0d, 0xec, 0x61, 0x00, 0x04, 0x00, 0x00, 0x00, 0x10, 0xc0, 0x01, 0x00,
	0x06, 0x18, 0x62, 0x00, 0x10, 0xc4, 0x01, 0x00, 0x50, 0x28, 0x00, 0x00,
	0x03, 0xa0, 0x21, 0x00, 0x3d, 0x00, 0x00, 0x00, 0x50, 0x28, 0x00, 0x00,
	0x03, 0xa0, 0x21, 0x00, 0x1c, 0x00, 0x48, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x18, 0x98, 0x81, 0x00, 0x29, 0x00, 0x00, 0x01, 0x04, 0x00, 0x00, 0x00,
	0x10, 0xfc, 0xff, 0x03, 0x11, 0xfc, 0xff, 0x03, 0x90, 0x10, 0x06, 0x00,
	0x50, 0x10, 0x02, 0x00, 0x06, 0x4c, 0x5b, 0x00, 0x1c, 0x84, 0x01, 0x00,
	0x1b, 0x90, 0x02, 0x00, 0x03, 0x48, 0x62, 0x00, 0x06, 0x98, 0x62, 0x00,
	0x10, 0x54, 0x55, 0x01, 0x11, 0x54, 0x55, 0x01, 0x1b, 0x90, 0x02, 0x00,
	0x03, 0x48, 0x62, 0x00, 0x06, 0x98, 0x62, 0x00, 0x10, 0xa8, 0xaa, 0x02,
	0x11, 0xa8, 0xaa, 0x02, 0x1b, 0x90, 0x02, 0x00, 0x03, 0x48, 0x62, 0x00,
	0x06, 0x98, 0x62, 0x00, 0x03, 0xac, 0x62, 0x00, 0x06, 0x98, 0x62, 0x00,
	0x03, 0xf0, 0x62, 0x00, 0x03, 0x9c, 0x63, 0x00, 0x03, 0xa8, 0x64, 0x00,
	0x18, 0x20, 0xc2, 0x00, 0x17, 0xec, 0xc2, 0x00, 0x06, 0x78, 0x65, 0x00,
	0x90, 0x10, 0x06, 0x00, 0x91, 0x00, 0x00, 0x00, 0x10, 0x00, 0x04, 0x00,
	0x11, 0x08, 0x0c, 0x00, 0xd0, 0x10, 0x10, 0x00, 0xd1, 0x10, 0x10, 0x00,
	0x50, 0x10, 0x02, 0x00, 0x1d, 0x08, 0x00, 0x00, 0x2c, 0xf0, 0xf7, 0x03,
	0x08, 0xe0, 0x62, 0x00, 0x10, 0x00, 0x04, 0x00, 0x11, 0x08, 0x0c, 0x00,
	0x06, 0xe4, 0x62, 0x00, 0xe1, 0x00, 0x00, 0x00, 0xa7, 0x00, 0x00, 0x00,
	0x0d, 0xc8, 0x62, 0x00, 0x04, 0x00, 0x00, 0x00, 0x90, 0x10, 0x06, 0x00,
	0x91, 0x00, 0x00, 0x00, 0x10, 0xfc, 0xfb, 0x03, 0x11, 0xf4, 0xf3, 0x03,
	0xd0, 0x10, 0x10, 0x00, 0xd1, 0x10, 0x10, 0x00, 0x50, 0x10, 0x02, 0x00,
	0x1d, 0x08, 0x00, 0x00, 0x2c, 0x0c, 0x08, 0x00, 0x08, 0x24, 0x63, 0x00,
	0x10, 0xfc, 0xfb, 0x03, 0x11, 0xf4, 0xf3, 0x03, 0x06, 0x28, 0x63, 0x00,
	0xe2, 0x00, 0x00, 0x00, 0xa7, 0x00, 0x00, 0x00, 0x0d, 0x0c, 0x63, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x50, 0x00, 0x02, 0x00, 0x90, 0x00, 0x04, 0x00,
	0x91, 0x00, 0x00, 0x00, 0xd0, 0xfc, 0xff, 0x03, 0xd1, 0xfc, 0xff, 0x03,
	0x1e, 0x08, 0x00, 0x00, 0xe6, 0x00, 0x00, 0x00, 0x1d, 0x08, 0x00, 0x00,
	0xa7, 0x00, 0x00, 0x00, 0x0d, 0x48, 0x63, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x18, 0xd8, 0x82, 0x00, 0x17, 0x6c, 0x42, 0x00, 0x03, 0x7c, 0x63, 0x00,
	0x37, 0x04, 0x00, 0x00, 0x1b, 0x00, 0x04, 0x00, 0x91, 0x00, 0x08, 0x00,
	0x06, 0x1c, 0x57, 0x00, 0x10, 0x40, 0x02, 0x00, 0x3d, 0x00, 0x00, 0x00,
	0x50, 0x04, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x3e, 0x04, 0x00, 0x00,
	0x50, 0x28, 0x00, 0x00, 0x03, 0xa0, 0x21, 0x00, 0x06, 0xe8, 0x15, 0x00,
	0x1c, 0xdc, 0x02, 0x00, 0xd8, 0x20, 0xc2, 0x00, 0xe3, 0x00, 0x00, 0x00,
	0x16, 0x08, 0x00, 0x00, 0x50, 0x02, 0x04, 0x00, 0x90, 0x02, 0x00, 0x00,
	0x03, 0x34, 0x62, 0x00, 0x16, 0x04, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00,
	0x20, 0x00, 0x00, 0x00, 0x2c, 0xfc, 0xff, 0x03, 0x07, 0xe8, 0x63, 0x00,
	0x03, 0x24, 0x14, 0x00, 0x03, 0x0c, 0x62, 0x00, 0x30, 0x60, 0x00, 0x00,
	0x0b, 0xe8, 0x63, 0x00, 0x10, 0xfc, 0xff, 0x03, 0x1f, 0x00, 0x00, 0x00,
	0x03, 0x54, 0x1b, 0x00, 0xa7, 0x02, 0x00, 0x00, 0x18, 0x20, 0xc2, 0x00,
	0xa1, 0x00, 0x00, 0x00, 0x16, 0x08, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00,
	0x0d, 0xbc, 0x63, 0x00, 0x04, 0x00, 0x00, 0x00, 0x9c, 0xdc, 0x02, 0x00,
	0x18, 0x20, 0xc2, 0x00, 0xa3, 0x00, 0x00, 0x00, 0x16, 0x10, 0x00, 0x00,
	0x50, 0x02, 0x04, 0x00, 0x90, 0x02, 0x00, 0x00, 0x03, 0x34, 0x62, 0x00,
	0x16, 0x04, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00,
	0x2c, 0x00, 0x00, 0x00, 0x07, 0x44, 0x64, 0x00, 0x18, 0x20, 0xc2, 0x00,
	0x21, 0x01, 0x00, 0x00, 0x16, 0x10, 0x00, 0x00, 0x06, 0x48, 0x64, 0x00,
	0x03, 0x58, 0x64, 0x00, 0xa7, 0x02, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00,
	0x0d, 0x24, 0x64, 0x00, 0x04, 0x00, 0x00, 0x00, 0x03, 0x54, 0x1b, 0x00,
	0x58, 0x20, 0xc2, 0x00, 0x41, 0x00, 0x00, 0x00, 0x51, 0x10, 0x06, 0x00,
	0x03, 0x8c, 0x14, 0x00, 0x27, 0x01, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00,
	0x6c, 0x04, 0x00, 0x00, 0x07, 0x94, 0x64, 0x00, 0x18, 0x38, 0x82, 0x00,
	0xb0, 0x59, 0x00, 0x00, 0x0b, 0x80, 0x64, 0x00, 0x3d, 0x00, 0x00, 0x00,
	0x68, 0x00, 0x00, 0x00, 0x06, 0x60, 0x64, 0x00, 0x10, 0x40, 0x00, 0x00,
	0xb0, 0x59, 0x00, 0x00, 0x0b, 0x98, 0x64, 0x00, 0x3d, 0x00, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x1c, 0xdd, 0x02, 0x00, 0x01, 0x01, 0x00, 0x00,
	0x18, 0x20, 0xc2, 0x00, 0x23, 0x01, 0x00, 0x00, 0x1b, 0xdc, 0x02, 0x00,
	0x16, 0x10, 0x00, 0x00, 0x50, 0x02, 0x04, 0x00, 0x90, 0x02, 0x00, 0x00,
	0x03, 0x34, 0x62, 0x00, 0x16, 0x04, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00,
	0x03, 0x04, 0x65, 0x00, 0x1c, 0xdd, 0x02, 0x00, 0x18, 0x20, 0xc2, 0x00,
	0x21, 0x01, 0x00, 0x00, 0x1b, 0xdc, 0x02, 0x00, 0x16, 0x10, 0x00, 0x00,
	0xa7, 0x02, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x0d, 0xd0, 0x64, 0x00,
	0x02, 0x01, 0x00, 0x00, 0x1b, 0xdd, 0x02, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x20, 0x00, 0x00, 0x00, 0x2c, 0xfc, 0xff, 0x03, 0x07, 0x3c, 0x5b, 0x00,
	0x96, 0x02, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x18, 0xac, 0x42, 0x00,
	0x95, 0x01, 0x00, 0x00, 0x98, 0x22, 0xc2, 0x00, 0x1c, 0x10, 0x08, 0x00,
	0x1b, 0xb8, 0x01, 0x00, 0x1c, 0x14, 0x08, 0x00, 0x1b, 0xbc, 0x01, 0x00,
	0xd0, 0x00, 0x00, 0x00, 0x03, 0x00, 0x1a, 0x00, 0x51, 0x10, 0x06, 0x00,
	0x03, 0x2c, 0x1a, 0x00, 0x03, 0x40, 0x1a, 0x00, 0x27, 0x01, 0x00, 0x00,
	0xac, 0x06, 0x00, 0x00, 0x07, 0x64, 0x65, 0x00, 0x18, 0x38, 0x82, 0x00,
	0x3d, 0x00, 0x00, 0x00, 0xa8, 0x02, 0x00, 0x00, 0x06, 0x34, 0x65, 0x00,
	0x10, 0x40, 0x00, 0x00, 0x3d, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00,
	0x16, 0x28, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x1c, 0xdd, 0x02, 0x00,
	0x01, 0x01, 0x00, 0x00, 0x18, 0x20, 0xc2, 0x00, 0x23, 0x01, 0x00, 0x00,
	0x1b, 0xdc, 0x02, 0x00, 0x16, 0x10, 0x00, 0x00, 0x50, 0x02, 0x04, 0x00,
	0x90, 0x02, 0x00, 0x00, 0x03, 0x34, 0x62, 0x00, 0x16, 0x04, 0x00, 0x00,
	0x41, 0x00, 0x00, 0x00, 0x03, 0xd4, 0x65, 0x00, 0x1c, 0xdd, 0x02, 0x00,
	0x18, 0x20, 0xc2, 0x00, 0x21, 0x01, 0x00, 0x00, 0x1b, 0xdc, 0x02, 0x00,
	0x16, 0x10, 0x00, 0x00, 0xa7, 0x02, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00,
	0x0d, 0xa0, 0x65, 0x00, 0x02, 0x01, 0x00, 0x00, 0x1b, 0xdd, 0x02, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x2c, 0xfc, 0xff, 0x03,
	0x07, 0x3c, 0x5b, 0x00, 0x18, 0xec, 0xc2, 0x00, 0x1b, 0x78, 0x02, 0x00,
	0x18, 0xd8, 0x42, 0x00, 0x2c, 0x08, 0x00, 0x00, 0x0a, 0x3c, 0x66, 0x00,
	0x1b, 0xa9, 0x01, 0x00, 0xd0, 0x00, 0x00, 0x00, 0x18, 0xac, 0x42, 0x00,
	0x95, 0x01, 0x00, 0x00, 0x03, 0x4c, 0x16, 0x00, 0x51, 0x20, 0x08, 0x00,
	0x03, 0x6c, 0x16, 0x00, 0x03, 0xa0, 0x66, 0x00, 0x18, 0x6d, 0x42, 0x00,
	0x2b, 0x10, 0x00, 0x00, 0x0a, 0x94, 0x66, 0x00, 0x1c, 0x78, 0x02, 0x00,
	0x28, 0x00, 0x00, 0x00, 0x0b, 0x3c, 0x5b, 0x00, 0x1b, 0x78, 0x02, 0x00,
	0x1c, 0xa9, 0x01, 0x00, 0x27, 0x01, 0x00, 0x00, 0x06, 0xf4, 0x65, 0x00,
	0xd0, 0x00, 0x00, 0x00, 0x18, 0xac, 0x42, 0x00, 0x95, 0x01, 0x00, 0x00,
	0x03, 0x4c, 0x16, 0x00, 0x03, 0x9c, 0x21, 0x00, 0x90, 0xfc, 0xff, 0x03,
	0x91, 0xfc, 0xff, 0x03, 0x50, 0x10, 0x02, 0x00, 0xb0, 0x31, 0x00, 0x00,
	0x0b, 0x5c, 0x66, 0x00, 0x03, 0xe8, 0x15, 0x00, 0x2b, 0x08, 0x00, 0x00,
	0x08, 0x94, 0x66, 0x00, 0x0d, 0x64, 0x66, 0x00, 0x26, 0x00, 0x00, 0x00,
	0x95, 0x01, 0x00, 0x00, 0x1c, 0x78, 0x02, 0x00, 0x28, 0x00, 0x00, 0x00,
	0x0b, 0x3c, 0x5b, 0x00, 0x1b, 0x78, 0x02, 0x00, 0x27, 0x01, 0x00, 0x00,
	0x06, 0x3c, 0x66, 0x00, 0x10, 0xfc, 0xff, 0x03, 0x1f, 0x00, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x10, 0x20, 0x08, 0x00, 0x17, 0xe4, 0xc2, 0x00,
	0x51, 0xc8, 0x01, 0x00, 0x50, 0x08, 0x00, 0x00, 0xb0, 0x59, 0x00, 0x00,
	0x0b, 0xb0, 0x66, 0x00, 0x78, 0x00, 0x00, 0x00, 0xb0, 0x59, 0x00, 0x00,
	0x0b, 0xbc, 0x66, 0x00, 0xb2, 0x49, 0x00, 0x00, 0xb1, 0x51, 0x00, 0x00,
	0x03, 0xe8, 0x15, 0x00, 0x16, 0x08, 0x00, 0x00, 0x03, 0xe8, 0x15, 0x00,
	0x34, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00,
	0x34, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00,
	0xb2, 0x51, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x36, 0x09, 0x00, 0x00,
	0x30, 0x01, 0x00, 0x00, 0x0b, 0xe0, 0x16, 0x00, 0x35, 0x00, 0x00, 0x00,
	0x36, 0x09, 0x00, 0x00, 0x10, 0x04, 0x00, 0x00, 0x30, 0x05, 0x00, 0x00,
	0x0c, 0x3c, 0x5b, 0x00, 0x10, 0x08, 0x00, 0x00, 0x30, 0x09, 0x00, 0x00,
	0x0c, 0x3c, 0x5b, 0x00, 0x10, 0x0c, 0x00, 0x00, 0x30, 0x0d, 0x00, 0x00,
	0x0c, 0x3c, 0x5b, 0x00, 0x10, 0x10, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x03, 0x54, 0x1b, 0x00, 0x03, 0x30, 0x14, 0x00, 0x03, 0x0c, 0x62, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x18, 0xac, 0x42, 0x00, 0x95, 0x01, 0x00, 0x00,
	0x10, 0x80, 0x01, 0x00, 0x3d, 0x00, 0x00, 0x00, 0x96, 0x10, 0x00, 0x00,
	0xd8, 0x30, 0x02, 0x02, 0x3e, 0x0d, 0x00, 0x00, 0x50, 0x0c, 0x00, 0x00,
	0x10, 0x80, 0x01, 0x00, 0x3d, 0x00, 0x00, 0x00, 0x18, 0x20, 0xc2, 0x00,
	0x2a, 0x00, 0x80, 0x00, 0x21, 0x01, 0x00, 0x00, 0x16, 0x10, 0x00, 0x00,
	0x3e, 0x0d, 0x00, 0x00, 0x0d, 0x68, 0x67, 0x00, 0x10, 0x40, 0x03, 0x00,
	0x3d, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x18, 0x8c, 0x01, 0x02,
	0x2c, 0xa0, 0x00, 0x00, 0x07, 0xa4, 0x67, 0x00, 0x06, 0x0c, 0x4a, 0x00,
	0x18, 0x00, 0xc2, 0x00, 0x55, 0x01, 0x00, 0x00, 0x1c, 0x90, 0x01, 0x00,
	0x5c, 0x94, 0x01, 0x00, 0x6f, 0x00, 0x00, 0x00, 0x77, 0x04, 0x00, 0x00,
	0x57, 0xd4, 0xc2, 0x00, 0x37, 0x04, 0x00, 0x00, 0x16, 0x10, 0x00, 0x00,
	0xd1, 0x00, 0xc0, 0x03, 0xe4, 0x00, 0x00, 0x00, 0x2d, 0x00, 0x00, 0x00,
	0x07, 0xdc, 0x67, 0x00, 0x06, 0x40, 0x4b, 0x00, 0x18, 0xa0, 0x02, 0x02,
	0x2c, 0x00, 0x00, 0x00, 0x07, 0x54, 0x4b, 0x00, 0x1c, 0x88, 0x01, 0x00,
	0x2a, 0x00, 0x40, 0x02, 0x17, 0xd4, 0xc2, 0x00, 0x06, 0x14, 0x4c, 0x00,
	0x06, 0xcc, 0x2a, 0x00, 0x06, 0xa0, 0x4a, 0x00, 0x70, 0x31, 0x00, 0x00,
	0x0c, 0xa0, 0x4a, 0x00, 0x1c, 0xd8, 0x02, 0x00, 0x2d, 0x00, 0x44, 0x03,
	0x07, 0x40, 0x68, 0x00, 0x2d, 0x00, 0x48, 0x03, 0x07, 0x20, 0x69, 0x00,
	0x2d, 0x00, 0x4c, 0x03, 0x07, 0xd8, 0x68, 0x00, 0x2d, 0x00, 0x50, 0x03,
	0x07, 0x30, 0x68, 0x00, 0x06, 0xa0, 0x4a, 0x00, 0x03, 0x10, 0x69, 0x00,
	0x1c, 0x00, 0x04, 0x00, 0x1b, 0xf8, 0x02, 0x00, 0x06, 0x24, 0x57, 0x00,
	0x10, 0x40, 0x1f, 0x00, 0x11, 0x10, 0x10, 0x00, 0x1b, 0xf8, 0x02, 0x00,
	0x10, 0xfc, 0xff, 0x03, 0x1b, 0x00, 0x04, 0x00, 0x03, 0xbc, 0x68, 0x00,
	0x03, 0x44, 0x6d, 0x00, 0x2c, 0x00, 0x00, 0x00, 0x08, 0xb4, 0x68, 0x00,
	0x51, 0x00, 0x04, 0x00, 0x57, 0xf4, 0x02, 0x03, 0x03, 0x60, 0x6a, 0x00,
	0x58, 0xf0, 0x42, 0x00, 0x6c, 0x00, 0x00, 0x00, 0x07, 0xb4, 0x68, 0x00,
	0x2c, 0xec, 0x00, 0x00, 0x07, 0x9c, 0x68, 0x00, 0x2c, 0x0c, 0x00, 0x00,
	0x08, 0xb4, 0x68, 0x00, 0x51, 0x04, 0x00, 0x00, 0x57, 0xf4, 0x02, 0x01,
	0x03, 0x78, 0x6d, 0x00, 0x10, 0xec, 0x00, 0x00, 0x17, 0x00, 0x44, 0x00,
	0x10, 0x01, 0x04, 0x00, 0x98, 0x9a, 0x41, 0x00, 0xa8, 0x02, 0x00, 0x00,
	0x50, 0x06, 0x00, 0x00, 0x03, 0x48, 0x6b, 0x00, 0x03, 0x18, 0x69, 0x00,
	0x06, 0x24, 0x57, 0x00, 0xb1, 0x2d, 0x00, 0x00, 0x03, 0x8c, 0x21, 0x00,
	0xb2, 0x25, 0x00, 0x00, 0x50, 0x20, 0x03, 0x00, 0x03, 0x6c, 0x21, 0x00,
	0xb2, 0x2d, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0xb1, 0x2d, 0x00, 0x00,
	0x03, 0x84, 0x21, 0x00, 0xb1, 0x25, 0x00, 0x00, 0x03, 0x18, 0x69, 0x00,
	0x06, 0x24, 0x57, 0x00, 0x10, 0x01, 0x04, 0x00, 0x98, 0x9a, 0x41, 0x00,
	0x50, 0x02, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x18, 0x98, 0x41, 0x00,
	0x29, 0x00, 0x00, 0x02, 0x29, 0x00, 0x00, 0x02, 0x16, 0x08, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x03, 0xfc, 0x68, 0x00, 0x06, 0x08, 0x56, 0x00,
	0x03, 0xfc, 0x68, 0x00, 0x06, 0x78, 0x56, 0x00, 0x18, 0x8c, 0x01, 0x02,
	0x2c, 0xa0, 0x00, 0x00, 0x07, 0x38, 0x69, 0x00, 0x03, 0x10, 0x69, 0x00,
	0x03, 0x50, 0x69, 0x00, 0x06, 0x40, 0x69, 0x00, 0x03, 0x50, 0x69, 0x00,
	0x03, 0x18, 0x69, 0x00, 0x18, 0xf0, 0x02, 0x02, 0x2c, 0x04, 0x00, 0x00,
	0x07, 0x24, 0x57, 0x00, 0x06, 0x30, 0x57, 0x00, 0x51, 0x00, 0x00, 0x00,
	0x57, 0xf0, 0x02, 0x01, 0x10, 0x95, 0x01, 0x00, 0x98, 0x92, 0x01, 0x02,
	0x50, 0x02, 0x00, 0x00, 0x03, 0x80, 0x6c, 0x00, 0x03, 0x44, 0x6d, 0x00,
	0x2c, 0x00, 0x00, 0x00, 0x07, 0x7c, 0x69, 0x00, 0x10, 0x00, 0x2c, 0x03,
	0x06, 0x4c, 0x6a, 0x00, 0x03, 0x60, 0x6a, 0x00, 0x17, 0xf4, 0x42, 0x00,
	0x50, 0x3c, 0xfc, 0x03, 0x65, 0x00, 0x00, 0x00, 0x2c, 0xbc, 0xfd, 0x03,
	0x07, 0x18, 0x6a, 0x00, 0x18, 0xf4, 0x42, 0x00, 0x50, 0x3c, 0xfc, 0x03,
	0x65, 0x00, 0x00, 0x00, 0x2c, 0x7c, 0xfe, 0x03, 0x07, 0x18, 0x6a, 0x00,
	0x58, 0xf4, 0x42, 0x00, 0x18, 0x94, 0x81, 0x00, 0x2b, 0x04, 0x00, 0x00,
	0x07, 0xe0, 0x69, 0x00, 0x51, 0x04, 0x00, 0x00, 0x57, 0xf0, 0x02, 0x01,
	0x50, 0xfc, 0x03, 0x00, 0x51, 0x00, 0x00, 0x00, 0x66, 0x00, 0x00, 0x00,
	0x58, 0xf4, 0x42, 0x00, 0x6b, 0x00, 0x00, 0x00, 0x07, 0xe0, 0x69, 0x00,
	0x10, 0x04, 0x2c, 0x03, 0x06, 0x4c, 0x6a, 0x00, 0x03, 0xec, 0x68, 0x00,
	0x18, 0x8c, 0x01, 0x02, 0x2c, 0xa0, 0x00, 0x00, 0x07, 0x00, 0x6a, 0x00,
	0x58, 0xf8, 0x02, 0x02, 0x03, 0x38, 0x6d, 0x00, 0x03, 0x80, 0x6c, 0x00,
	0x06, 0x04, 0x6a, 0x00, 0x03, 0x48, 0x6b, 0x00, 0x96, 0x02, 0x00, 0x00,
	0x2c, 0x00, 0x00, 0x00, 0x07, 0x68, 0x69, 0x00, 0x10, 0x08, 0x2c, 0x03,
	0x06, 0x4c, 0x6a, 0x00, 0x18, 0xf4, 0x42, 0x00, 0x2c, 0x80, 0x01, 0x00,
	0x07, 0x68, 0x69, 0x00, 0x03, 0x44, 0x6d, 0x00, 0x03, 0x60, 0x6a, 0x00,
	0x29, 0x00, 0x00, 0x02, 0x17, 0xf4, 0x82, 0x00, 0x18, 0xf4, 0x42, 0x00,
	0x2c, 0x40, 0x02, 0x00, 0x08, 0x50, 0x6a, 0x00, 0x11, 0x00, 0x04, 0x00,
	0x17, 0xf0, 0x02, 0x02, 0x04, 0x00, 0x00, 0x00, 0x17, 0xf4, 0xc2, 0x00,
	0x11, 0x00, 0x00, 0x00, 0x17, 0xf0, 0x02, 0x02, 0x1c, 0xf4, 0x02, 0x00,
	0x06, 0xb8, 0x57, 0x00, 0x10, 0x00, 0x00, 0x00, 0x17, 0xf0, 0x42, 0x00,
	0xd0, 0x00, 0x00, 0x00, 0x03, 0xf8, 0x6d, 0x00, 0x26, 0x00, 0x00, 0x00,
	0x90, 0x00, 0x00, 0x00, 0x50, 0x20, 0x00, 0x00, 0x32, 0x20, 0x00, 0x00,
	0x70, 0x1d, 0x00, 0x00, 0x0c, 0x8c, 0x6a, 0x00, 0x06, 0x94, 0x6a, 0x00,
	0x31, 0x20, 0x00, 0x00, 0xa7, 0x00, 0x00, 0x00, 0x2a, 0x00, 0x40, 0x00,
	0x03, 0xfc, 0x6d, 0x00, 0x0d, 0x7c, 0x6a, 0x00, 0x58, 0xf4, 0x02, 0x02,
	0x6c, 0x00, 0x00, 0x00, 0x07, 0xc4, 0x6a, 0x00, 0x03, 0xfc, 0x6d, 0x00,
	0x51, 0x00, 0x00, 0x00, 0x57, 0xf4, 0x02, 0x02, 0x50, 0x04, 0x00, 0x00,
	0x57, 0xf0, 0x42, 0x00, 0x04, 0x00, 0x00, 0x00, 0x58, 0xf4, 0x02, 0x01,
	0x6c, 0x00, 0x00, 0x00, 0x07, 0xdc, 0x6a, 0x00, 0x70, 0x1d, 0x00, 0x00,
	0x0b, 0xe4, 0x6a, 0x00, 0x06, 0xf0, 0x6a, 0x00, 0x70, 0x1d, 0x00, 0x00,
	0x0b, 0xf0, 0x6a, 0x00, 0xb0, 0x00, 0x00, 0x00, 0x0b, 0xf8, 0x6a, 0x00,
	0x06, 0x24, 0x6b, 0x00, 0xb0, 0x00, 0x00, 0x00, 0x0b, 0x24, 0x6b, 0x00,
	0xe7, 0x00, 0x00, 0x00, 0xec, 0x10, 0x00, 0x00, 0x07, 0x3c, 0x5b, 0x00,
	0x03, 0xfc, 0x6d, 0x00, 0xb1, 0x25, 0x00, 0x00, 0x03, 0xfc, 0x6d, 0x00,
	0xb2, 0x25, 0x00, 0x00, 0x03, 0x44, 0x6d, 0x00, 0x2c, 0x00, 0x00, 0x00,
	0x08, 0x3c, 0x5b, 0x00, 0x06, 0x6c, 0x6a, 0x00, 0x50, 0x04, 0x00, 0x00,
	0x57, 0xf0, 0x42, 0x00, 0x03, 0x00, 0x6e, 0x00, 0xb2, 0x25, 0x00, 0x00,
	0x58, 0xf4, 0x02, 0x01, 0x6c, 0x00, 0x00, 0x00, 0x07, 0xf8, 0x6d, 0x00,
	0x03, 0x78, 0x6d, 0x00, 0x06, 0xf8, 0x6d, 0x00, 0x03, 0x44, 0x6d, 0x00,
	0x2c, 0x04, 0x00, 0x00, 0x07, 0x3c, 0x5b, 0x00, 0x03, 0x60, 0x6a, 0x00,
	0x58, 0xf0, 0x42, 0x00, 0x6c, 0x04, 0x00, 0x00, 0x08, 0x3c, 0x5b, 0x00,
	0x6c, 0x02, 0x00, 0x00, 0x07, 0x98, 0x6b, 0x00, 0x29, 0x00, 0x00, 0x02,
	0x6c, 0x06, 0x00, 0x00, 0x07, 0xa0, 0x6b, 0x00, 0x29, 0x00, 0x00, 0x02,
	0x6c, 0x0a, 0x00, 0x00, 0x07, 0xa8, 0x6b, 0x00, 0x29, 0x00, 0x00, 0x02,
	0x19, 0x10, 0x00, 0x02, 0x27, 0x01, 0x00, 0x00, 0x50, 0x02, 0x00, 0x00,
	0x06, 0xb0, 0x6b, 0x00, 0x19, 0x10, 0x40, 0x00, 0x06, 0xac, 0x6b, 0x00,
	0x19, 0x10, 0x80, 0x00, 0x06, 0xac, 0x6b, 0x00, 0x19, 0x10, 0x00, 0x01,
	0x67, 0x02, 0x00, 0x00, 0xa8, 0x02, 0x00, 0x00, 0x0b, 0x3c, 0x5b, 0x00,
	0x06, 0x48, 0x6b, 0x00, 0x58, 0xf4, 0x02, 0x01, 0x6c, 0x00, 0x00, 0x00,
	0x07, 0xcc, 0x6b, 0x00, 0x03, 0x78, 0x6d, 0x00, 0x29, 0x00, 0x00, 0x02,
	0x17, 0xf0, 0x82, 0x00, 0xd0, 0x00, 0x00, 0x00, 0x18, 0xf0, 0x82, 0x00,
	0xb1, 0x25, 0x00, 0x00, 0x03, 0xfc, 0x6d, 0x00, 0x90, 0x00, 0x00, 0x00,
	0x50, 0x20, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x6c, 0x00,
	0xb2, 0x25, 0x00, 0x00, 0xa7, 0x00, 0x00, 0x00, 0x06, 0x04, 0x6c, 0x00,
	0xb1, 0x25, 0x00, 0x00, 0x2a, 0x00, 0x40, 0x00, 0x03, 0xfc, 0x6d, 0x00,
	0x0d, 0xec, 0x6b, 0x00, 0x58, 0xf4, 0x02, 0x01, 0x6c, 0x00, 0x00, 0x00,
	0x07, 0x28, 0x6c, 0x00, 0xb0, 0x00, 0x00, 0x00, 0x0b, 0x30, 0x6c, 0x00,
	0x06, 0x38, 0x6c, 0x00, 0xb0, 0x00, 0x00, 0x00, 0x0b, 0x38, 0x6c, 0x00,
	0xb2, 0x25, 0x00, 0x00, 0x06, 0x3c, 0x6c, 0x00, 0xb1, 0x25, 0x00, 0x00,
	0x03, 0xfc, 0x6d, 0x00, 0xb2, 0x25, 0x00, 0x00, 0x03, 0x14, 0x6e, 0x00,
	0x70, 0x1d, 0x00, 0x00, 0x0c, 0x74, 0x6c, 0x00, 0x03, 0xf8, 0x6d, 0x00,
	0xe7, 0x00, 0x00, 0x00, 0xec, 0x0c, 0x00, 0x00, 0x07, 0x68, 0x6c, 0x00,
	0x03, 0x34, 0x6d, 0x00, 0x06, 0xd8, 0x6b, 0x00, 0x90, 0x00, 0x00, 0x00,
	0x97, 0xf0, 0x42, 0x00, 0x04, 0x00, 0x00, 0x00, 0x90, 0x04, 0x00, 0x00,
	0x97, 0xf0, 0x42, 0x00, 0x04, 0x00, 0x00, 0x00, 0x6c, 0x0e, 0x00, 0x00,
	0x07, 0xb0, 0x6c, 0x00, 0x6c, 0x0a, 0x00, 0x00, 0x07, 0xa8, 0x6c, 0x00,
	0x6c, 0x06, 0x00, 0x00, 0x07, 0xa0, 0x6c, 0x00, 0x1a, 0x10, 0x40, 0x00,
	0x06, 0xc0, 0x6c, 0x00, 0x1a, 0x10, 0x80, 0x00, 0x06, 0xc0, 0x6c, 0x00,
	0x1a, 0x10, 0x00, 0x01, 0x06, 0xc0, 0x6c, 0x00, 0x1a, 0x10, 0x00, 0x02,
	0x27, 0x01, 0x00, 0x00, 0x50, 0x02, 0x00, 0x00, 0x06, 0xc4, 0x6c, 0x00,
	0x67, 0x02, 0x00, 0x00, 0x03, 0xbc, 0x6b, 0x00, 0x18, 0xf0, 0x42, 0x00,
	0x2c, 0x04, 0x00, 0x00, 0x08, 0x3c, 0x5b, 0x00, 0xa8, 0x02, 0x00, 0x00,
	0x0b, 0x3c, 0x5b, 0x00, 0x18, 0xf0, 0x02, 0x01, 0x2c, 0x04, 0x00, 0x00,
	0x07, 0xf4, 0x6c, 0x00, 0x03, 0xf8, 0x6d, 0x00, 0x03, 0x34, 0x6d, 0x00,
	0x06, 0x80, 0x6c, 0x00, 0x03, 0x44, 0x6d, 0x00, 0x2c, 0x04, 0x00, 0x00,
	0x07, 0x3c, 0x5b, 0x00, 0x03, 0x60, 0x6a, 0x00, 0x58, 0xf0, 0x42, 0x00,
	0x6c, 0x04, 0x00, 0x00, 0x08, 0x3c, 0x5b, 0x00, 0x58, 0xf4, 0x42, 0x00,
	0x2b, 0x04, 0x00, 0x00, 0x07, 0x80, 0x6c, 0x00, 0x58, 0x94, 0x81, 0x00,
	0x2b, 0x04, 0x00, 0x00, 0x08, 0x80, 0x6c, 0x00, 0x11, 0x00, 0x00, 0x00,
	0x17, 0xf0, 0x02, 0x01, 0x06, 0x80, 0x6c, 0x00, 0x58, 0xf8, 0x02, 0x01,
	0x03, 0xfc, 0x6d, 0x00, 0x0d, 0x38, 0x6d, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x58, 0xf8, 0xc2, 0x00, 0x41, 0x00, 0x00, 0x00, 0x50, 0x20, 0x4e, 0x00,
	0x70, 0x1d, 0x00, 0x00, 0x0b, 0x6c, 0x6d, 0x00, 0x0d, 0x50, 0x6d, 0x00,
	0x42, 0x00, 0x00, 0x00, 0x0d, 0x48, 0x6d, 0x00, 0x10, 0x04, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x50, 0xfc, 0x03, 0x00,
	0x51, 0x00, 0x00, 0x00, 0x66, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00,
	0x30, 0x00, 0x00, 0x00, 0x0b, 0x98, 0x6d, 0x00, 0x71, 0x1c, 0x00, 0x00,
	0x30, 0x04, 0x00, 0x00, 0x0b, 0xa4, 0x6d, 0x00, 0x71, 0x18, 0x00, 0x00,
	0x30, 0x08, 0x00, 0x00, 0x0b, 0xb0, 0x6d, 0x00, 0x71, 0x14, 0x00, 0x00,
	0x30, 0x0c, 0x00, 0x00, 0x0b, 0xbc, 0x6d, 0x00, 0x71, 0x10, 0x00, 0x00,
	0x30, 0x10, 0x00, 0x00, 0x0b, 0xc8, 0x6d, 0x00, 0x71, 0x0c, 0x00, 0x00,
	0x30, 0x14, 0x00, 0x00, 0x0b, 0xd4, 0x6d, 0x00, 0x71, 0x08, 0x00, 0x00,
	0x30, 0x18, 0x00, 0x00, 0x0b, 0xe0, 0x6d, 0x00, 0x71, 0x04, 0x00, 0x00,
	0x30, 0x1c, 0x00, 0x00, 0x0b, 0xec, 0x6d, 0x00, 0x71, 0x00, 0x00, 0x00,
	0x56, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x03, 0x00, 0x6e, 0x00, 0x03, 0x00, 0x6e, 0x00, 0x41, 0x00, 0x00, 0x00,
	0x50, 0x44, 0x0c, 0x00, 0x03, 0xa0, 0x21, 0x00, 0x42, 0x00, 0x00, 0x00,
	0x04, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x50, 0x48, 0x12, 0x00,
	0x03, 0xa0, 0x21, 0x00, 0x42, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00
};

/* Celly SIM Card Reader:
 * Device initialization data - write buffer 3 */
static const unsigned char celly_buf_3[4] = { 0x00, 0x20, 0x04, 0x2a };

/* Device initialization data - read buffer 
 * (Generic - can be used by any device) */
static unsigned char init_read_buf[4096] = { 0x00 };

/* Structure to hold everything necessary to send an initialization command
 * to the device */
struct device_init_cmd {

	/* SIM_READ, SIM_WRITE, or SIM_NO_XFER */
	int direction;

	/* Raw SCSI CDB (command data block) */
	unsigned char cdb[MAX_CDB_LEN];

	/* Length of data buffer */
	unsigned int data_len;

	/* Pointer to data buffer. The data can be output (for a write command)
	 * or input (for a read command). */
	unsigned char *data;
};

/* Structure to hold everything necessary to define a SCSI-based SIM card reader */
struct device {

	/* Maximum length of SCSI sense buffer for the device */
	unsigned char sense_len;

	/* Offset in sense data for type */
	unsigned char sense_type_offset;

	/* Offset in sense data for ASC (additional sense code) */
	unsigned char sense_asc_offset;

	/* Offset in sense data for ASCQ (additional sense code qualifier) */
	unsigned char sense_ascq_offset;

	/* SCSI READ and WRITE command codes for the device */
	unsigned char scsi_cmd_read;
	unsigned char scsi_cmd_write;

	/* SCSI CDB (command data block) length for the device */
	unsigned char cdb_len;

	/* CDB for the GSM SELECT command */
	unsigned char CDB_select_file[MAX_CDB_LEN];

	/* CDB and relevant offsets for the GSM GET RESPONSE command */
	unsigned char CDB_get_response[MAX_CDB_LEN];
	unsigned char get_response_len_offset;

	/* CDB and relevant offsets for the GSM READ RECORD command */
	unsigned char CDB_read_record[MAX_CDB_LEN];
	unsigned char read_record_rec_offset;
	unsigned char read_record_len_offset;

	/* CDB and relevant offsets for the GSM READ BINARY command */
	unsigned char CDB_read_binary[MAX_CDB_LEN];
	unsigned char read_binary_hi_offset;
	unsigned char read_binary_lo_offset;
	unsigned char read_binary_len_offset;

	/* CDB and relevant offsets for the GSM UPDATE RECORD command */
	unsigned char CDB_update_record[MAX_CDB_LEN];
	unsigned char update_record_rec_offset;
	unsigned char update_record_len_offset;

	/* CDB and relevant offsets for the GSM UPDATE BINARY command */
	unsigned char CDB_update_binary[MAX_CDB_LEN];
	unsigned char update_binary_hi_offset;
	unsigned char update_binary_lo_offset;
	unsigned char update_binary_len_offset;

	/* CDB and relevant offsets for the GSM VERIFY CHV command */
	unsigned char CDB_verify_chv[MAX_CDB_LEN];
	unsigned char verify_chv_chvnum_offset;

	/* CDB and relevant offsets for raw, arbitrary GSM command */
	unsigned char CDB_raw_cmd[MAX_CDB_LEN];
	unsigned char raw_cmd_direction_offset;
	unsigned char raw_cmd_gsm_cmd_offset;
	unsigned char raw_cmd_p1_offset;
	unsigned char raw_cmd_p2_offset;
	unsigned char raw_cmd_p3_offset;

	/* Initialization commands: the size of 16 for this array is completely 
	 * arbitrary. The device I have sends 9 init commands. If a device turns 
	 * up that needs more than 15 init commands (15 commands plus SIM_NO_XFER
	 * array terminator), it's easy enough to increase this array's size. */
	struct device_init_cmd init_cmd[16];

};

/* "Magic" LBA (logical block addressing) for GSM commands on Celly SIM card reader, 
 * as determined by sniffing USB packets */
#define CELLY_LBA_1	0x00
#define CELLY_LBA_2	0xd2
#define CELLY_LBA_3	0x00
#define CELLY_LBA_4	0x05

static const struct device sim_devices[1] = {
	{	/* BEGIN definitions for Celly SIM Card Reader */
		.sense_len = 32,
		.sense_type_offset = 0,
		.sense_asc_offset = 12,
		.sense_ascq_offset = 13,
		.scsi_cmd_read = SCSI_CMD_READ_10,
		.scsi_cmd_write = SCSI_CMD_WRITE_10,
		.cdb_len = 10,
		.CDB_select_file = {
			SCSI_CMD_WRITE_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_SELECT,
			0x00,
			0x00,
			GSM_CMD_SELECT_DATA_LEN
		},
		.CDB_get_response = {
			SCSI_CMD_READ_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_GET_RESPONSE,
			0x00,
			0x00,
			0x00
		},
		.get_response_len_offset = 9,
		.CDB_read_record = {
			SCSI_CMD_READ_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_READ_RECORD,
			0x00,
			0x04, /* Absolute mode: see GSM spec, sections 8.5 and 9.2.5 */
			0x00
		},
		.read_record_rec_offset = 7,
		.read_record_len_offset = 9,
		.CDB_read_binary = {
			SCSI_CMD_READ_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_READ_BINARY,
			0x00,
			0x00,
			0x00
		},
		.read_binary_hi_offset = 7,
		.read_binary_lo_offset = 8,
		.read_binary_len_offset = 9,
		.CDB_update_record = {
			SCSI_CMD_WRITE_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_UPDATE_RECORD,
			0x00,
			0x04, /* Absolute mode: see GSM spec, sections 8.6 and 9.2.6 */
			0x00
		},
		.update_record_rec_offset = 7,
		.update_record_len_offset = 9,
		.CDB_update_binary = {
			SCSI_CMD_WRITE_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_UPDATE_BINARY,
			0x00,
			0x00,
			0x00
		},
		.update_binary_hi_offset = 7,
		.update_binary_lo_offset = 8,
		.update_binary_len_offset = 9,
		.CDB_verify_chv = {
			SCSI_CMD_WRITE_10,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			GSM_CMD_VERIFY_CHV,
			0x00,
			0x00,
			GSM_CMD_VERIFY_CHV_DATA_LEN
		},
		.verify_chv_chvnum_offset = 8,
		.CDB_raw_cmd = {
			0x00,
			CELLY_LBA_1,
			CELLY_LBA_2,
			CELLY_LBA_3,
			CELLY_LBA_4,
			GSM_CLASS,
			0x00,
			0x00,
			0x00,
			0x00
		},
		.raw_cmd_direction_offset = 0,
		.raw_cmd_gsm_cmd_offset = 6,
		.raw_cmd_p1_offset = 7,
		.raw_cmd_p2_offset = 8,
		.raw_cmd_p3_offset = 9,
		.init_cmd = {
			/* Array of initialization commands to send to the device. scsisim_init_device()
			 * sends these commands in the specified order to get the device ready to 
			 * accept GSM commands. */
			{
				SIM_READ,
				{ SCSI_CMD_READ_10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00 },
				512,
				init_read_buf
			},
			{
				SIM_READ,
				{ SCSI_CMD_READ_10, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x04, 0x00 },
				2048,
				init_read_buf
			},
			{
				SIM_READ,
				{ SCSI_CMD_READ_10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00 },
				4096,
				init_read_buf
			},
			{
				SIM_READ,
				{ SCSI_CMD_READ_10, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00 },
				512,
				init_read_buf
			},
			{
				SIM_WRITE,
				{ SCSI_CMD_WRITE_10, 0x00, 0x22, 0x80, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00 },
				sizeof(celly_buf_1),
				(unsigned char*)celly_buf_1
			},
			{
				SIM_WRITE,
				{ SCSI_CMD_WRITE_10, 0x00, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00 },
				sizeof(celly_buf_2),
				(unsigned char*)celly_buf_2
			},
			{
				SIM_READ,
				{ SCSI_CMD_READ_10, 0x00, 0xd1, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20 },
				512,
				init_read_buf
			},
			{
				SIM_WRITE,
				{ SCSI_CMD_WRITE_10, 0x00, 0xd4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04 },
				sizeof(celly_buf_3),
				(unsigned char*)celly_buf_3
			},
			{
				SIM_READ,
				{ SCSI_CMD_READ_10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00 },
				512,
				init_read_buf
			},
			{ SIM_NO_XFER }
		}
	},	/* END definitions for Celly SIM Card Reader */
	/* Add future devices here */
};


#endif  /* __SCSISIM_DEVICE_H__ */

/* EOF */

